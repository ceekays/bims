class LoginController < ApplicationController
  layout "admin"
before_filter :authorize, :except => :login

   def add_user
      @pagetitle = " Baobab Inventory Management System: Add User Page"
      @my_title = "Adding Users Form "
       #raise  " params is #{params[:users]}"  
        
     @user = User.new(params[:users])
     # @user.date_created = Time.now
     # @user.creator = 1
     # @user.person_id = 3
     
     if request.post? && @user.save
          #redirect_to(:action => "index")
          flash[:notice] = "User #{@user.username} created"
          @user = User.new
     end
  end

  def login
         @pagetitle = " Baobab Inventory Management System: Login Page"
         @my_title = "Users Login Form "
         
      session[:user_id] = nil

      if request.post?
        user = User.authenticate(params[:username], params[:password])
        if user
          session[:user_id] = user.user_id
          session[:username] = user.username
          
          uri = session[:original_uri]
          session[:original_uri] = nil
          
          redirect_to(uri || { :action => "index" })
          flash[:notice] = "You have succesfully logged in"
        else
          flash[:notice] = "Invalid user/password combination"
        end
      end
  end

  def logout
  end

  def index
  end

  def delete_user
  end

  def list_users
  end

end
